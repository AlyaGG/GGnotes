本质：扩散模型，且是生成模型(生成它训练数据的新数据)
# 1 SD扩散模型工作原理


![[Pasted image 20240610165213.png]]


## 1.1 前向扩散
（墨水扩散，噪声添加的过程）
![[Pasted image 20240610165503.png]]
在前向扩散的过程中对“噪声预测器（unetl）”进行训练
## 1.2 反向扩散
（去噪的过程）
![[Pasted image 20240610165751.png]]

每一次去噪叫采样（采样器在图像生成中的作用）
## 1.3 总结
1.像素空间=潜空间48（压缩率）
==2.扩散过程如果在像素空间进行，会数据量庞大，做相同的工作GPU要跑更久，所以要去潜空间进行数据转换，潜空间可以作为纯数学的表达，解决此问题==
# 2 SD工作过程
![[Pasted image 20240610170439.png]]
- 条件输入：图片，文本或者其它内容
- 编码器（encode）：
- 潜空间（U-net）：在U-net进行一个去噪的过程
- vae解码器（decode）：将生成的数据（去噪结果）还原到像素空间
	- 因为从潜空间直接生成的数据，无法直接查看，需还原成像素组成的图片才会被人类看到


![[Pasted image 20240610171112.png]]
## 2.1 在comfy内工作过程的复现


![[Pasted image 20240610171219.png]]
- 条件输入：图片，文本或者其它内容（大模型，lora等）都属于输入
- 潜空间（U-net）：在U-net进行一个去噪的过程——==采样器==
- vae解码器（decode）：通过decode将生成的数据（去噪结果）还原到像素空间
# 3 SD各项功能的理解
## 3.1 潜空间的工作流程

![[潜空间工作流程]]
### 3.1.1 vae：
==进入退出潜空间的一种手段==
Encoder——编码器 （进入潜空间的编码）
decoder——解码器（还原像素空间的解码）
![[Pasted image 20240610171855.png]]
ps：每一轮就是一个step，参数中的step代表了要经过多少轮的过程

## 3.2 Text Conditioning 文本条件
![[Pasted image 20240610174943.png]]

- 识别text把语义详尽的指向同一区域与
	- man,guy,gentleman 都会指向同一类型的区域
	- ![[Pasted image 20240610175236.png]]
- 把自然语言相似，语义不同的指向不同
	Monet·莫奈
	Manet 画风不同
	